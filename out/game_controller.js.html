<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: game_controller.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: game_controller.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict'
//Game states kept here
//This allows for security or whatever
//send from here to go to view.
var jsonfile = require('jsonfile')
var file = __dirname+"/game_scores.json"
var scores;
var game;

get_scores(console.log)


exports.gc_get_scores = function(req, res){
    get_scores(function(data){
        res.send(data)
    })
}

/** Saves score 
 * @exports save_score
 */
exports.save_score = function(req, res){
    var id = scores.Scores.Players.length
    console.log("SCORE: "+req.params.score)
    var players = scores.Scores.Players
    var obj = {
        id : id,
        name : req.params.name,
        score : req.params.score
    }
    console.log(obj)
    var data = players.push(obj)
    
    jsonfile.writeFile(file, scores, {spaces: 2}, function (err) {
        console.error(err)
        res.send("Success")
    })
    
    
    
}

/** Get score from file */
function get_scores(callback){
    jsonfile.readFile(file, function(err, obj) {
        console.dir(obj)
        callback(obj)
        scores = obj
        console.log("Scores ===============", obj.Scores.Players.length)
    })
}


/**
 * @exports new_game
 * new game on server
 */
exports.new_game = function(req, res){
    var w = req.params.width
    var h = req.params.height
    var m = req.params.mines
    game = new minesweeper(w, h, m)
    console.log(game.getInfo())
    res.send(game.getInfo())
}

/** Minesweeper field create */
function minesweeper(width, height, mines){
    this.width = width;
    this.height = height;
    this.mines = mines;
    this.getInfo = function(){
        return 'Width/height/mines:' + this.width + ' ' + this.height + ' ' + this.mines;
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-new_game.html">new_game</a></li><li><a href="module-save_score.html">save_score</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jul 30 2018 08:35:11 GMT+0000 (UTC)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
